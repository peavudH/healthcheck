<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>healthcheck</title>
    <script type="text/javascript" src="jquery-1.8.3.js"></script>
    <script type="text/javascript">
        //ajax请求后台数据
        function ajaxRequest() {
            $.ajax({
                type:"POST",
                url:"/checkallservice",
                success: function(model){
                    var tr = $("cloneTr");

                    $.each(model,function (index, item) {
                        //克隆产生新的tr
                        var cloneTr = tr.clone();
                        var _index = index;
                        cloneTr.children("td").each(function (inner_index) {
                            //根据索引为每一个td赋值
                            switch(inner_index){
                                case(0):
                                    $(this).html(_index + 1);
                                    break;
                                case(1):
                                    $(this).html(item.serverName);
                                    break;
                                case(2):
                                    $(this).html(item.serviceHost);
                                    break;
                                case(3):
                                    $(this).html(item.port);
                                    break;
                                case(4):
                                    $(this).html(item.result);
                                    break;

                            }//end switch
                        });//end children.each

                        //把克隆好的tr追加原来的tr后面
                        clonedTr.insertAfter(tr);
                    });//end $each
                    $("#cloneTr").hide();//隐藏id=cloneTr的tr，因为该tr中的td没有数据，不隐藏起来会在生成的table第一行显示一个空行
                    $("#generatedTable").show();
                },
                dataType: JSON
            });
        }
    </script>
</head>
<body>
    <center style="padding-top: 4%">
        <div style="font-size: large;padding-bottom: 2%" >服务器运行状态</div>
        <div align="right" style="width: 50%;padding-bottom: 1%"><button id="refresh">刷新</button></div>
        <table id="generatedTable" align="center" border="1" cellpadding="0" cellspacing="0" width="50%" >
            <thead>
                <tr>
                    <th>服务器名称</th>
                    <th>IP地址</th>
                    <th>服务端口</th>
                    <th>运行状态</th>
                </tr>
            </thead>
            <tbody th:if="${not #lists.isEmpty(list)}" >
                <tr id="cloneTr" th:each="customResponse:${list}" align="center" height="20">
                    <td th:text="${customResponse.serverName}"></td>
                    <td th:text="${customResponse.serviceHost}"></td>
                    <td th:text="${customResponse.port}"></td>
                    <td th:if="${customResponse.result}==true"><span>正常</span></td>
                    <td th:if="${customResponse.result}==false"><span>异常</span></td>
                </tr>
            </tbody>
        </table>
    </center>

</body>
</html>